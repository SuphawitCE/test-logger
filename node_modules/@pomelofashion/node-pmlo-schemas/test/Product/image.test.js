const joi = require('joi');
const { image } = require('../../src').ProductSchema;

const images = require('../fixtures/images.json');

describe('image schema tests', () => {
  test('should successfully pass validation', () => {
    const imageDetail = { ...images };
    const { error } = image.validate(imageDetail);
    expect(error).toBe(undefined);
  });

  test('should fail if image has invalid store/shop specified', () => {
    const imageDetail = { ...images };

    imageDetail.uk = {
      cover:
        'https://d2ooe7uanou0ka.cloudfront.net/img/p/2/1/7/4/8/7/217481.jpg',
      hover:
        'https://d2ooe7uanou0ka.cloudfront.net/img/p/2/1/7/4/8/7/217482.jpg',
      flatlay: null,
      smartly: null,
      marketplace: null,
      closeup: null,
      additional: []
    };

    const { error } = image.validate(imageDetail);
    expect(error.message).toEqual('"uk" is not allowed');
    expect(error.name).toEqual('ValidationError');
  });
});
